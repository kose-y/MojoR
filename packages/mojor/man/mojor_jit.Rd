% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/roxygen_api_docs.R
\name{mojor_jit}
\alias{mojor_jit}
\title{Create a Runtime-Specializing JIT Wrapper}
\usage{
mojor_jit(
fn,
...,
name = "mojor_jit_kernel",
elementwise = FALSE,
elementwise_target = c("cpu", "gpu"),
elementwise_size = NULL,
elementwise_cpu = NULL,
broadcast = c(
"none",
"scalar",
"recycle",
"recycle_warn",
"broadcast_nd",
"broadcast_nd_warn"
),
disk_cache = NULL,
cache_dir = NULL,
signatures = NULL,
eager = FALSE,
strict_signatures = NULL,
parallel = FALSE,
object_mode = c("off", "fallback", "hybrid"),
semantics = c("r", "raw"),
fast_math = NULL,
bounds_check = NULL
)
}
\arguments{
\item{fn}{Function to specialize and compile.}

\item{...}{Optional runtime type hints forwarded to \code{\link[=mojor_build]{mojor_build()}}.}

\item{name}{Kernel name prefix.}

\item{elementwise}{Enable elementwise lowering when legal.}

\item{elementwise_target}{Elementwise target backend (\code{"cpu"} or \code{"gpu"}).}

\item{elementwise_size}{Optional elementwise launch/work size hint.}

\item{elementwise_cpu}{Optional CPU-only elementwise override.}

\item{broadcast}{Broadcast/recycling policy.}

\item{disk_cache}{If \code{TRUE}, persist JIT signature index on disk. If \code{NULL},
uses \code{mojor_options("jit_disk_cache")}.}

\item{cache_dir}{Optional persistent cache directory used when disk cache is enabled.}

\item{signatures}{Optional declared signatures for eager precompile (named type-list signatures or signature strings).}

\item{eager}{If \code{TRUE}, compile all declared \code{signatures} at wrapper creation.}

\item{strict_signatures}{If \code{TRUE}, runtime signatures must match declared \code{signatures}.
If \code{NULL}, uses \code{mojor_options("jit_strict_signatures")}.}

\item{parallel}{Enable parallel loop routing when legal.}

\item{object_mode}{Object fallback mode: \code{"off"}, \code{"fallback"}, or \code{"hybrid"}.}

\item{semantics}{Semantics mode forwarded to \code{\link[=mojor_build]{mojor_build()}} (\code{"r"} or \code{"raw"}).}

\item{fast_math}{Fast-math toggle forwarded to \code{\link[=mojor_build]{mojor_build()}} (\code{TRUE}, \code{FALSE}, or \code{NULL}).}

\item{bounds_check}{Bounds-check toggle forwarded to \code{\link[=mojor_build]{mojor_build()}} (\code{TRUE}, \code{FALSE}, or \code{NULL}).}
}
\value{
A function. On each call it infers argument types, reuses/creates a compiled kernel
for that signature, and returns the kernel result.
}
\description{
Create a callable wrapper that infers argument types at runtime, builds kernels on demand,
and caches compiled call paths by signature.
}
\examples{
f <- function(x) {
out <- numeric(length(x))
for (i in 1:length(x)) out[i] <- x[i] * 3
out
}

\dontrun{
jf <- mojor_jit(f)
jf(c(1, 2, 3))
}
}
